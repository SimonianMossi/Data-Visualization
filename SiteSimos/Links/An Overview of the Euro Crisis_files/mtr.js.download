/* $Id: mtr.js 7dcf45c 2021-05-03T20:57:09.923Z Gurnot, Frederic <Frederic.Gurnot@nytimes.com> $ */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){"function"==typeof define&&define.amd?define("auth/gateway/creatives",[],function(){return e()}):"object"==typeof NYTD&&(NYTD.GatewayCreatives=e())}(function(){return{defaultGateways:{iframeOverlay:'<span class="adxInfo mktInfo" style="display:none">campaign: iframeNYT5_gw, creative: gateway, source: mtr.js</span><style>@charset \'UTF-8\'; .nowrap{white-space: nowrap;}#overlay1{position: relative; background: #fff; width: 100%; height: 100%; z-index: 1000000139; opacity: 0.7; bottom: 0; left: 0 !important;}#overlay3{background: #fff; width: 100%; height: 100%; opacity: 0.7; position: relative; z-index: 1000000139; bottom: 0; left: 0 !important;}body{overflow-y: auto;}body.noScroll{overflow-y: hidden;}#supercontainer{width: 100%; height: 100%; position: fixed; left: 0 !important; bottom: 110px; padding: 0; z-index: 1000000139;}.container__creative{position: fixed; width: 94%; max-width: 1170px; height: 81vh; overflow: hidden; padding: 0; border-style: solid; border-width: 0; top: calc(50% + 24px); -webkit-transform: translateY(-50%); transform: translateY(-50%); background: #fff; background-repeat: none; z-index: 1000000139; margin: 0 auto; left: 0; right: 0; -webkit-box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.25); box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.25); -webkit-box-sizing: border-box; box-sizing: border-box;}.container__creative .scroll-container{overflow-y: auto; overflow-x: hidden; position: relative; top: -1px; bottom: 0; left: 0; right: -17px; height: 100%; width: 100%; text-align: center;}.container__creative section{display: block; height: auto; width: 100%; -webkit-box-sizing: border-box; box-sizing: border-box;}.container__creative .container{max-width: 985px; padding: 40px; margin: 0 auto; height: auto; width: 100%; font-family: "nyt-franklin", "Helvetica Neue", Arial, sans-serif; -webkit-box-sizing: border-box; box-sizing: border-box;}@media only screen and (max-width: 1024px){.container__creative .container{padding: 40px 2%;}}.container__creative .subtitle .container{padding: 0;}.container__creative .subtitle p{font-size: 20px;}.container__creative a:hover{text-decoration: none;}#mag-issue-nav{display: none;}#mtrjsIframeContainer{position: relative; width: 100%; max-width: 1570px; height: 81vh; overflow: hidden; padding: 0; border-style: solid; border-width: 0; top: 50%; -webkit-transform: translateY(-50%); transform: translateY(-50%); background-repeat: none; z-index: 1000000139; margin: 0 auto; left: 0; right: 0; -webkit-box-sizing: border-box; box-sizing: border-box;}#mtrjsIframeContainer.abx_is_iPad{-webkit-overflow-scrolling: touch !important; overflow-y: scroll !important;}#mtrjsIframe{width: 100%; height: 100%;}.container__creative{background-image: linear-gradient( 90deg, rgba(245, 245, 245, 0) 0, rgba(245, 245, 245, 0.8) 50%, rgba(245, 245, 245, 0) 100% ), linear-gradient(white 34px, transparent 0), linear-gradient(white 26px, transparent 0), linear-gradient(white 26px, transparent 0), repeating-linear-gradient( to right, #fff, #fff 10%, lightgrey 10%, lightgrey 30% ), linear-gradient(#f5f5f5 280px, transparent 0); background-size: 200px 280px, 420px 34px, 600px 26px, 200px 26px, 100% 280px, 100% 100%; background-position: -50% 0, 50% 85px, 50% 140px, 50% 190px, 0 320px, 0 0; background-repeat: no-repeat; -webkit-animation: loading 1.5s infinite; animation: loading 1.5s infinite;}@-webkit-keyframes loading{to{background-position: 150% 0, 50% 85px, 50% 140px, 50% 190px, 0 320px, 0 0; background-size: 200px 280px, 420px 34px, 600px 26px, 200px 26px, 100% 280px, 100% 100%;}}@keyframes loading{to{background-position: 150% 0, 50% 85px, 50% 140px, 50% 190px, 0 320px, 0 0; background-size: 200px 280px, 420px 34px, 600px 26px, 200px 26px, 100% 280px, 100% 100%;}}body[class^="eln-"] #gatewayCreative{z-index: 2000000 !important;}</style><div id="supercontainer" class="nytdGrowlUIContainer"> <div id="overlay1"></div><div id="overlay3"></div></div><div class="container__creative font-smoothing"> <div id="mtrjsIframeContainer"> <iframe id="mtrjsIframe" src="https://www.nytimes.com/subscription?mktgEmbedSrc=gateway" ></iframe> </div></div>',regiwallCreative:'<style>@charset \'UTF-8\';.nowrap{white-space:nowrap}#overlay1{position:relative;background:#fff;width:100%;height:100%;z-index:1000000139;opacity:.7;bottom:0;left:0!important}#overlay3{background:#fff;width:100%;height:100%;opacity:.7;position:relative;z-index:1000000139;bottom:0;left:0!important}body{overflow-y:auto}body.noScroll{overflow-y:hidden}#supercontainer{width:100%;height:100%;position:fixed;left:0!important;bottom:110px;padding:0;z-index:1000000139}.container__creative{font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;position:fixed;width:94%;max-width:1170px;height:81vh;overflow:hidden;padding:0;border-style:solid;border-width:0;top:calc(50% + 24px);-webkit-transform:translateY(-50%);transform:translateY(-50%);background:#fff;background-repeat:none;z-index:1000000139;margin:0 auto;left:0;right:0;-webkit-box-shadow:0 0 12px 0 rgba(0,0,0,.25);box-shadow:0 0 12px 0 rgba(0,0,0,.25);-webkit-box-sizing:border-box;box-sizing:border-box}.container__creative .scroll-container{overflow-y:auto;overflow-x:hidden;position:relative;top:-1px;bottom:0;left:0;right:-17px;height:100%;width:100%;text-align:center}.container__creative section{display:block;height:auto;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.container__creative .container{max-width:985px;padding:40px;margin:0 auto;height:auto;width:100%;font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;-webkit-box-sizing:border-box;box-sizing:border-box}@media only screen and (max-width:1024px){.container__creative .container{padding:40px 2%}}.container__creative .subtitle .container{padding:0}.container__creative .subtitle p{font-size:20px}.container__creative a:hover{text-decoration:none}#mag-issue-nav{display:none}#mtrjsRegiWallContainer{position:relative;width:100%;max-width:1570px;height:81vh;overflow:hidden;padding:0;border-style:solid;border-width:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);background-repeat:none;z-index:1000000139;margin:0 auto;left:0;right:0;-webkit-box-sizing:border-box;box-sizing:border-box}#mtrjsRegiWallContainer.abx_is_iPad{-webkit-overflow-scrolling:touch!important;overflow-y:scroll!important}.regiwall{width:100%;height:100%}body[class^=eln-] #gatewayCreative{z-index:2000000!important}</style><div id="supercontainer"class="nytdGrowlUIContainer"><div id="overlay1"></div><div id="overlay3"></div></div><div class="container__creative font-smoothing"><div id="mtrjsRegiWallContainer"><style>.regiwall{display:flex;align-items:center;justify-content:center;height:-webkit-fill-available}.dockGateway-logo-nyt{width:256px;height:32px;margin:0 auto 30px}.dockGateway-headline-container{font-size:18px;line-height:20px;margin-top:20px;text-align:center;font-weight:700;color:#121212;font-family:nyt-cheltenham,georgia,"times new roman",times,serif}.dockGateway-headline-container .DockGateway-headline_desktop span{display:block;white-space:unset}@media screen and (min-width:450px){.dockGateway-headline-container .DockGateway-headline_desktop span{white-space:nowrap;display:inline-block}}.dockGateway-headline-container .lineDescrip{display:none}@media screen and (min-width:740px){.dockGateway-headline-container .lineDescrip{display:block}}.DockGateway-subhead_desktop{font-weight:300;font-size:18px;line-height:131.3%;max-width:264px;margin:20px auto}#DockGateway-limit{margin-top:25px;text-align:center}#DockGateway-limit span{font-weight:700}.DockGateway-separator{display:block;height:1px;width:300px;border-bottom:1px solid #000;margin:59px auto 34px}@media screen and (min-width:740px){.dockGateway-headline-container{font-size:20px;line-height:20px;margin-right:0;padding:0 50px;text-align:center}.DockGateway-subhead_desktop{margin-top:5px;font-size:20px;line-height:20px;font-weight:300;max-width:500px}.DockGateway-separator{width:250px;margin:80px auto 54px}}@media screen and (min-width:767px){.dockGateway-headline-container{font-size:22px;line-height:24px}.DockGateway-subhead_desktop{font-size:22px;line-height:24px}}@media screen and (min-width:1024px){.dockGateway-headline-container{font-size:30px;line-height:30px}.DockGateway-subhead_desktop{font-size:30px;line-height:131%}}.container{margin:0 auto;height:auto;width:90%;font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif}a:hover{text-decoration:none}.buttonContainer{margin:40px auto 30px;background-color:#000;border-radius:3px;width:min-content;height:35px;line-height:35px}.buttonContainer a{color:#000}.buttonContainer .loginButton{font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;background:#333;color:#fff;font-weight:700;text-align:center;font-size:12px;border-radius:3px;width:200px}@media screen and (min-width:740px){.buttonContainer{width:200px;height:40px;line-height:40px}.buttonContainer .loginButton{font-size:14px}}@media screen and (max-width:739px){.subtitle .container{text-align:left}.container{width:initial}.buttonsContainer{margin:0}}.lineDescrip{font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;font-weight:300;color:#000;font-size:18px;line-height:18px;margin-top:22px;text-align:center}.lineDescrip .contact{font-size:16px;line-height:19px}.lineDescrip .contact a,a.log-in-top-link,a.log-in-top-link:hover{text-decoration:underline;color:#000}@media only screen and (max-width:739px){.lineDescrip .contact a{display:block}}.gateway-link{font-weight:600}</style><div class="page regiwall"><script type="text/javascript">console.log(\'(document.domain: \' + document.domain)</script><div class="page__content"><div class="dockGateway-logo-nyt"><img src="https://mwcm.nyt.com/dam/jcr:ed0cab84-abb3-432e-8c00-f370cf194043/logo_nyt.svg"></div><div class="dockGateway-headline-container"><div><p></p><div class="DockGateway-headline_desktop">Thanks for reading The Times</div><div class="DockGateway-subhead_desktop">Create a free account or log in for access to more of The Times.</div><p></p></div></div><div class="buttonContainer"><a class="tracking__continue"href="https://myaccount.nytimes.com/auth/login?URI=https://www.nytimes.com/"><div class="loginButton">CONTINUE</div></a></div><div id="DockGateway-limit">Already a subscriber? <a class="gateway-link log-in-top-link tracking__login"href="https://myaccount.nytimes.com/auth/login?URI=https://www.nytimes.com/">Log in</a></div><div class="DockGateway-separator"></div><div class="lineDescrip"><span class="contact">Support independent journalism. <a class="gateway-link tracking__subscription"href="https://www.nytimes.com/subscription.html?campaignId=7Q87L"target="_blank">See more subscription options</a></span></div></div></div><div class="banner__container"style="display:none"><a id="closeCross"></a> <a class="banner__container__cta--accept"></a> <a class="banner__container__cta--manage"></a> <a id="cookie_policy"></a></div></div></div>',backupStatic:'<span class="adxInfo mktInfo" style="display:none">campaign: defaultNYT5_gw, creative: gateway, source: mtr.js</span><style>@charset "UTF-8";@font-face{font-family: franklin-italic-600; src: local("â˜ºï¸Ž"), url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.woff) format("woff"), url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.ttf) format("truetype"); font-style: italic; font-weight: 600;}@font-face{font-family: franklin-normal-600; src: local("â˜ºï¸Ž"), url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.woff) format("woff"), url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.ttf) format("truetype"); font-style: normal; font-weight: 600;}@font-face{font-family: franklin; src: local("â˜ºï¸Ž"), url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.woff) format("woff"), url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.ttf) format("truetype"); font-style: italic; font-weight: 600;}@font-face{font-family: franklin; src: local("â˜ºï¸Ž"), url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.woff) format("woff"), url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.ttf) format("truetype"); font-style: normal; font-weight: 600;}.font-smoothing{-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.nowrap{white-space: nowrap;}.gateway_outer_wrapper{-webkit-box-sizing: border-box; box-sizing: border-box; padding: 0 15px;}.gateway_wrapper{-webkit-box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.25); box-shadow: 0 0 12px 0 rgba(0, 0, 0, 0.25); -webkit-box-sizing: border-box; box-sizing: border-box; color: #000000; font-family: "nyt-franklin", "Helvetica Neue", Arial, sans-serif; height: 380px; margin: 0 auto; max-width: 370px; width: 100%;}@media only screen and (min-width: 780px){.gateway_wrapper{max-width: 750px;}}.status_bar{background-color: #ebebeb; color: #fff; font-family: franklin-normal-600, "nyt-franklin", "Helvetica Neue", Arial, sans-serif; font-size: 10px; font-weight: 600; height: 30px; line-height: 1; position: relative; text-transform: uppercase; width: 100%;}@media only screen and (min-width: 780px){.status_bar{font-size: 14px; text-transform: none;}}.art_rem_left{left: 20px; position: absolute; top: 10px;}@media only screen and (min-width: 780px){.art_rem_left{top: 8px;}}.login_right{position: absolute; right: 20px; top: 10px;}@media only screen and (min-width: 780px){.login_right{top: 8px;}}.login_right a:visited,.login_right a:link{color: #343434; text-decoration: underline;}.user-logged-in .login_right{display: none;}.gw_content{background-color: #ebebeb; -webkit-box-sizing: border-box; box-sizing: border-box; color: #000; display: block; height: 350px; padding-left: 20px; padding-top: 43px; position: relative; text-decoration: none; width: 100%;}@media only screen and (min-width: 780px){.gw_content{padding-left: 60px; padding-top: 80px;}}.gw_content:hover{text-decoration: none;}.gw_content:visited,.gw_content:link{color: #000;}.gw_headline_main{font-size: 20px; font-weight: 700; line-height: 1.3; margin-bottom: 8px;}@media only screen and (min-width: 780px){.gw_headline_main{font-size: 26px; line-height: 1.38; margin-bottom: 1px;}}.gw_headline_sub{font-size: 20px; font-weight: 300; line-height: 1.3; margin-bottom: 37px;}@media only screen and (min-width: 780px){.gw_headline_sub{font-size: 26px; line-height: 1.38; margin-bottom: 35px;}}.gw_cta{background-color: #343434; border-radius: 3px; color: #fff; font-size: 12px; font-weight: 700; height: 30px; line-height: 30px; text-align: center; width: 150px;}.gw_logo{bottom: 40px; position: absolute; right: 40px; width: 155px;}@media only screen and (min-width: 780px){.gw_logo{right: 60px; width: 210px;}}.only_show_large{display: none;}@media only screen and (min-width: 780px){.only_show_large{display: inline;}}</style><div class="gateway_outer_wrapper"><div class="gateway_wrapper font-smoothing"><div class="status_bar"><div class="art_rem_left"></div><div class="login_right"><span class="only_show_large">Already a subscriber?</span><a href="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=mtr_js&redirect_uri=https%3A%2F%2Fwww.nytimes.com" id="default_gw_login_url">Log in</a></div></div><a href="https://www.nytimes.com/subscription/multiproduct/lp8HYKU.html?campaignId=77UFW" class="gw_content" id="default_gw_url"><div class="gw_headline_main">Help Times journalists uncover <span class="nowrap">the next big story.</span></div><div class="gw_headline_sub">Subscribe to <span class="nowrap">The New York Times.</span></div><div class="gw_cta">SEE MY OPTIONS</div><img class="gw_logo" src="https://mwcm.nyt.com/dam/mkt_assets/exo/img/nyt-logo-379x64.svg" alt="The New York Times"/></a></div></div><script>var loginLink=document.getElementById(\'default_gw_login_url\'); var loginUrl=loginLink.href; var windowURL=window.location.href; loginLink.href=loginUrl.replace(\'https://www.nytimes.com/\', windowURL); var userInfo=window.NYToptly.userInfo; if (userInfo.regi_id !==0){document.documentElement.classList.add(\'user-logged-in\');}</script>'},defaultGrowls:{"default":'<span class="adxInfo mktInfo"style="display:none">campaign: default_growl, creative: growl, source: mtr.js</span><style>@charset "UTF-8";@font-face{font-family:franklin-italic-600;src:local("â˜ºï¸Ž"),url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.woff) format("woff"),url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.ttf) format("truetype");font-style:italic;font-weight:600}@font-face{font-family:franklin-normal-600;src:local("â˜ºï¸Ž"),url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.woff) format("woff"),url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.ttf) format("truetype");font-style:normal;font-weight:600}@font-face{font-family:franklin;src:local("â˜ºï¸Ž"),url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.woff) format("woff"),url(https://g1.nyt.com/fonts/family/franklin/franklin-italic-600.ttf) format("truetype");font-style:italic;font-weight:600}@font-face{font-family:franklin;src:local("â˜ºï¸Ž"),url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.woff) format("woff"),url(https://g1.nyt.com/fonts/family/franklin/franklin-normal-600.ttf) format("truetype");font-style:normal;font-weight:600}.font-smoothing{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.nowrap{white-space:nowrap}.growl-exp{opacity:0;height:330px;position:absolute;bottom:0;z-index:998;-webkit-transition:opacity .45s ease-out,.5s;transition:opacity .45s ease-out,.5s;visibility:hidden}@media only screen and (max-width:1270px){.growl-exp{height:280px}}@media only screen and (max-width:900px){.growl-exp{height:196px}}.growl-exp.show-medium{opacity:1;z-index:999;visibility:visible}.growl-exp.hide-medium{opacity:0;z-index:998;visibility:hidden}.growl-exp--header{z-index:11111111111;opacity:1}.closeAsset{cursor:pointer;position:absolute;top:15px;right:23px;z-index:11111111}@media only screen and (max-width:900px){.closeAsset{display:none}}.closeAsset .arrow-icon-expGrowl{height:11px;width:17px}.closeAsset .arrow-icon-expGrowl .arrow-icon--path-expGrowl{fill:none;stroke:#9B9B9B;stroke-width:2;stroke-miterlimit:10;-webkit-transition:stroke .3s ease-in,1s;transition:stroke .3s ease-in,1s}@media only screen and (max-width:900px){.closeAsset .arrow-icon-expGrowl .arrow-icon--path-expGrowl{stroke:#fff}}.closeAsset .arrow-icon-expGrowl .arrow-icon-expGrowl:hover .arrow-icon--path-expGrowl{height:75px;width:75px}.expanded_right_headline{font-size:22px;font-weight:300;line-height:1.5;color:#2e2e2e;margin-bottom:16px}@media only screen and (max-width:1270px){.expanded_right_headline{font-size:16px;margin-bottom:12px}}.growl-col{opacity:1;width:100%;height:100%;z-index:999;-webkit-transition:opacity .25s ease-in,0s;transition:opacity .25s ease-in,0s}@media only screen and (max-width:900px){.growl-col{height:46px}}.growl-col.hide-small{display:none;z-index:998}.growl-col.show-small{opacity:1;z-index:999}.growl-col--inner{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}@media only screen and (max-width:900px){.growl-col--inner{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}}.col__cta-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:auto;padding-right:48px}@media only screen and (max-width:900px){.col__cta-container{display:none!important}}.meter-5 .col__cta-container{padding-right:25px}.tagline-offer-text{padding-left:16px;font-weight:500;color:#343434;font-size:18px;white-space:nowrap}@media only screen and (max-width:1024px){.tagline-offer-text{padding-top:0;font-size:16px}}@media only screen and (max-width:900px){.tagline-offer-text{font-size:13px}}.tagline-bold{font-weight:700;color:#303538}a.cta-smallScrn{display:none}@media only screen and (max-width:900px){a.cta-smallScrn{color:#343434;font-size:13px;font-weight:600;text-decoration:underline;text-transform:capitalize;display:inline-block}}.rem-arts-small-container{height:100%;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;border-right:1px solid #ADADAD;width:10%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0;-ms-flex-negative:0;flex-shrink:0}@media only screen and (max-width:900px){.rem-arts-small-container{display:none}}.articles-remain-count{font-size:24px;font-weight:500;color:#343434;margin-bottom:3px;line-height:1}@media only screen and (max-width:1024px){.articles-remain-count{font-size:18px;margin:0 0 5px 0}}@media only screen and (max-width:900px){.articles-remain-count{display:none}}.articles-remain-copy{color:#343434;font-family:franklin-normal-600,nyt-franklin,"Helvetica Neue",Arial,sans-serif;font-size:9px;text-transform:uppercase}@media only screen and (max-width:1046px) and (min-width:901px){.remove_small{display:none}}.login-wrapper{padding-left:25px}@media only screen and (max-width:900px){.login-wrapper a{color:#fff;font-size:10px}}@media only screen and (max-width:1024px){.subscriber-copy-already{display:none}}.subscriber-copy-login-small{display:none}@media only screen and (max-width:1024px){.subscriber-copy-login-small{display:block}}.user-logged-in .growl-wrapper.getMedium .expanded_login_link,.user-logged-in .subscriber-link{display:none}#instl,#instl_container,#instl_supercontainer{display:none}.growl_open{width:96%}@media only screen and (min-width:901px){.growl_open .bug_open{display:none}}.growl-wrapper{-webkit-box-sizing:border-box;box-sizing:border-box;font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;background-color:#EFEFEF;overflow:hidden;padding:0;max-width:1170px;height:60px;position:fixed;margin:0 0 8px 2%;left:0;right:0;bottom:-80px;-webkit-box-shadow:0 0 14px 0 rgba(0,0,0,.23);box-shadow:0 0 14px 0 rgba(0,0,0,.23);z-index:1000000100;-webkit-transition:height .6s ease-in-out,.25s;transition:height .6s ease-in-out,.25s;border-radius:2px}@media only screen and (min-width:1238px){.growl-wrapper{margin:0 0 8px calc((100% - 1170px)/ 2)}}@media only screen and (max-width:1024px){.growl-wrapper{height:50px}}@media only screen and (max-width:900px){.growl-wrapper{height:70px;width:100%;margin:0;-webkit-box-shadow:none;box-shadow:none}}.growl-wrapper.getMedium{height:330px;padding:0}@media only screen and (max-width:1270px){.growl-wrapper.getMedium{height:280px}}@media only screen and (max-width:900px){.growl-wrapper.getMedium{height:220px}}.growl-wrapper.getMedium .expanded_login_link{display:block}.growl_bug_container svg{position:absolute;top:50%;margin-top:-7px;left:50%;margin-left:-4.5px;height:14px;width:7px}@media only screen and (min-width:901px){.growl_bug_container{position:absolute;right:0;top:0;width:23px;height:100%;background-color:#ADADAD;cursor:pointer;z-index:1000;border-bottom-right-radius:2px;border-top-right-radius:2px}}@media only screen and (max-width:900px){.growl_bug_container{display:none}}.small_close{width:11px;height:7px}.smallScrn-meterCount{display:none}@media only screen and (max-width:900px){.smallScrn-meterCount{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#343434;color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;font-family:franklin-normal-600,nyt-franklin,"Helvetica Neue",Arial,sans-serif;font-size:9px;font-weight:600;height:24px;line-height:1;position:relative;width:100%}}.smallScrn-meterCount .toggle_bug{height:100%;width:24px;text-align:center;margin-right:8px;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.growl_closed .smallScrn-meterCount .toggle_bug{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.meter-5 .smallScrn-meterCount .toggle_bug{display:none}.smallScrn-meterCount .closeAsset{display:none}.getMedium .smallScrn-meterCount .closeAsset{height:100%;width:24px;text-align:center;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:8px;position:static}.article_remaining_info{margin-left:20px}a.expanded_login_link{display:none}@media only screen and (max-width:900px){a.expanded_login_link{color:#fff;display:block;font-family:nyt-franklin,"Helvetica Neue",Arial,sans-serif;font-weight:700;text-decoration:underline;text-transform:uppercase;margin-left:auto;margin-right:12px}}.growl-wrapper--inner{width:100%}.growl-wrapper--inner .cta-btn{background-color:transparent;color:#2D2D2D;height:30px;padding:0 25px;text-align:center;text-transform:uppercase;font-size:11px;font-weight:700;border-radius:4px;border:1px solid #2D2D2D;-webkit-transition:all .3s 0s,.4s;transition:all .3s 0s,.4s;display:inline-block;line-height:32px;text-decoration:none;-webkit-box-sizing:border-box;box-sizing:border-box}@media only screen and (max-width:900px){.growl-wrapper--inner .cta-btn{display:none}}.getMedium .growl-wrapper--inner .cta-btn,.growl-wrapper--inner .cta-btn:hover{background-color:#2D2D2D;color:#fff}.growl-wrapper--inner .cta-btn:active{border:none;-webkit-box-shadow:none;box-shadow:none}.expanded_left{-webkit-box-sizing:border-box;box-sizing:border-box;width:60%;height:100%;background-color:#ebebeb;float:left;padding:2%;box-sizing:border-box}@media only screen and (max-width:620px){.expanded_left{width:100%}}@media only screen and (max-width:900px){.expanded_left{background-color:#ebebeb}}.small_width_cta.cta-btn{display:none}@media only screen and (max-width:900px){.small_width_cta.cta-btn{display:inline-block;margin-top:1em}}.expanded_left__inner{opacity:0;top:400px;-webkit-transition:all .25s ease-in-out,.85s;transition:all .25s ease-in-out,.85s;width:100%}.expanded_left__inner .show-medium-inner{opacity:1;top:0}.expanded_left__inner .striker-growl-exp{color:#7a9f7e}.expanded_left__inner .striker-growl-exp::before{position:absolute;width:100%;height:3px;background-color:#fd432e;content:"";bottom:39%}.sale-hero{float:right;-webkit-box-sizing:border-box;box-sizing:border-box;width:174px;height:233px;padding-right:5%}.show-medium-inner{opacity:1;top:0;float:left}.meter-wrap{font-family:franklin-normal-600,nyt-franklin,"Helvetica Neue",Arial,sans-serif;font-weight:600;font-size:14px;color:#fff;font-weight:500;position:absolute;bottom:35px;left:42px}.meter-wrap .articles-remain-copy{font-weight:600;font-size:14px;color:#fff;font-weight:500}@media only screen and (max-width:900px){.meter-wrap{display:none}}@media only screen and (max-width:1270px){.meter-wrap{bottom:25px;font-size:12px}.meter-wrap .articles-remain-copy{font-size:12px}}.meter-wrap .articles-remain-copy{text-transform:lowercase}.expanded_right{position:relative;width:40%;background-color:#F6F6F6;height:100%;float:left;-webkit-box-sizing:border-box;box-sizing:border-box}@media only screen and (max-width:900px){.expanded_right{background-color:#ebebeb}}@media only screen and (max-width:620px){.expanded_right{display:none}}@media only screen and (max-width:900px){.subscriber-link{display:none}}.expanded_right--inner{position:absolute;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:100%;height:100%;text-align:center;opacity:0;top:300px;-webkit-transition:all .25s ease-in-out,.85s;transition:all .25s ease-in-out,.85s;-webkit-box-sizing:border-box;box-sizing:border-box}.expanded_right--inner.show-medium-inner{opacity:1;top:50%}@media only screen and (max-width:900px){.expanded_right--inner{width:100%;height:auto}}.growl_bundle_lockup{width:209px;height:73px;margin-bottom:22px;margin-top:77px}@media only screen and (max-width:1270px){.growl_bundle_lockup{margin-top:53px;margin-bottom:18px}}@media only screen and (max-width:900px){.growl_bundle_lockup{margin-top:0}}.growl_bundle_lockup.international_bundle{width:134px}@media only screen and (max-width:900px){.hide_content_small{display:none}}.arrow-icon{-webkit-transition:left .3s ease-in,0s;transition:left .3s ease-in,0s;height:19.5px;width:19.5px;display:inline;position:relative;top:6.5px;left:-6px;padding-bottom:1px}.arrow-icon .arrow-icon--path{fill:none;stroke:#ABABAB;stroke-width:2;stroke-miterlimit:10;-webkit-transition:stroke .3s ease-in,0s;transition:stroke .3s ease-in,0s}.getMedium .subscriber-link{text-align:center;position:absolute;left:0;right:0;bottom:35px;color:#9b9b9b;font-size:14px}.getMedium .subscriber-link a{color:#9b9b9b}@media only screen and (max-width:1270px){.getMedium .subscriber-link a{font-size:12px}}@media only screen and (max-width:1270px){.getMedium .subscriber-link{bottom:25px;font-size:12px}}.subscriber-link a{font-family:franklin-normal-600,nyt-franklin,"Helvetica Neue",Arial,sans-serif;color:#2e2e2e;text-decoration:underline;font-size:14px;-webkit-transition:color .1s ease-in,0s;transition:color .1s ease-in,0s;white-space:nowrap}.notransition{-webkit-transition:none!important;transition:none!important}@media only screen and (max-width:900px){.growl_closed.growl-wrapper{height:24px}}@media only screen and (min-width:901px){.growl_closed{width:calc(9.6% + 23px);max-width:140px}}@media only screen and (min-width:901px){.growl_closed .growl-col--inner .rem-arts-small-container{width:calc(100% - 23px);background-color:#EFEFEF;z-index:99999;max-width:117px}}@media only screen and (min-width:901px){.growl_closed .bug_collapse{display:none}}@media only screen and (min-width:901px){.meter-5 .growl_bug_container{display:none}}.hideGrowlElements{display:none}.getMedium .growl-wrapper--inner .cta-btn{background-color:#333;border:1px solid #333}.expanded_left{background-color:#ebebeb;padding-top:80px;padding-left:40px;padding-right:40px}@media only screen and (max-width:900px){.expanded_left{background-color:#ebebeb;padding-left:20px;padding-right:20px;padding-top:30px}}@media only screen and (min-width:900px){.break_large{display:block}}.tagline-bold{font-weight:500;color:#2e2e2e}.meter-wrap,.meter-wrap .articles-remain-copy{color:#000}.default_growl_headline{font-size:26px;font-weight:700;line-height:1.15;margin-bottom:22px;color:#000}@media only screen and (max-width:900px){.default_growl_headline{font-size:20px;margin-bottom:12px}}.default_growl_subhead{font-size:26px;font-weight:300;line-height:1.15;color:#000}@media only screen and (max-width:900px){.default_growl_subhead{font-size:20px}}@media only screen and (max-width:900px){.small_width_cta.cta-btn{margin-top:22px}}</style><div class="growl-wrapper growl_open font-smoothing"><div class="smallScrn-meterCount"><div class="article_remaining_info"><span class="js-smallScrn-meterCount__count">&nbsp;</span> <span class="js-smallScrn-meterCount__copy">ARTICLES REMAINING</span></div><a href="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=mtr_js&redirect_uri=https%3A%2F%2Fwww.nytimes.com"class="expanded_login_link">Log in</a> <span class="toggle_bug"><svg class="small_close"><use xlink:href="#small_close"/></svg></span><span class="closeAsset"><svg class="small_close"><use xlink:href="#small_close"/></svg></span></div><div id="growl_bug"class="growl_bug_container toggle_bug"><svg class="bug_collapse"><use xlink:href="#bug_collapse"/></svg> <svg class="bug_open"><use xlink:href="#bug_open"/></svg></div><div class="growl-col growl-wrapper--inner"><div class="growl-col--inner"><div class="rem-arts-small-container"><div class="js-articles-remain-count articles-remain-count">&nbsp;</div><div class="articles-remain-copy"><span class="remove_small">ARTICLES</span> REMAINING</div></div><div class="tagline-offer-text"><span class="tagline-bold">Subscribe to The New York Times.</span></div>&nbsp;<a href="https://www.nytimes.com/subscription/multiproduct/lp8HYKU.html?campaignId="class="cta-smallScrn"target="_blank">SEE OPTIONS</a><div class="col__cta-container"><a href="https://www.nytimes.com/subscription/multiproduct/lp8HYKU.html?campaignId="class="cta-btn"id="cta-link-collapsed"target="_blank">SEE MY OPTIONS</a><div class="login-wrapper subscriber-link"><a href="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=mtr_js&redirect_uri=https%3A%2F%2Fwww.nytimes.com"class=""><span class="subscriber-copy-already">Subscriber login</span> <span class="subscriber-copy-login-small">Log in</span></a></div></div></div></div><div class="growl-exp growl-wrapper--inner"><div class="growl-exp--header"><a class="closeAsset"><svg class="arrow-icon-expGrowl"><use xlink:href="#close_expanded"/></svg></a></div><div class="expanded_left"><div class="expanded_left__inner"><div class="default_growl_headline">Help Times journalists uncover <span class="nowrap break_large">the next big story.</span></div><div class="default_growl_subhead">Subscribe to <span class="nowrap">The New York Times.</span></div><a href="https://www.nytimes.com/subscription/multiproduct/lp8HYKU.html?campaignId="class="small_width_cta cta-btn"id="cta-link-expanded-small"target="_blank">SEE MY OPTIONS</a></div><div class="meter-wrap"><span class="js-articles-remain-count">&nbsp;</span> <span class="articles-remain-copy">articles remaining</span> this month</div></div><div class="expanded_right"><div class="expanded_right--inner"><svg class="growl_bundle_lockup international_bundle"><use xlink:href="#lockup_international"/></svg><div class="hide_content_small"><div class="expanded_right_headline">See where The New York Times will take you.</div><a href="https://www.nytimes.com/subscription/multiproduct/lp8HYKU.html?campaignId="class="cta-btn"id="cta-link-expanded"target="_blank">SEE MY OPTIONS</a></div></div><div class="subscriber-link">Already a subscriber? <a href="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=mtr_js&redirect_uri=https%3A%2F%2Fwww.nytimes.com">Log in.</a></div></div></div></div><svg style="display:none"xmlns="http://www.w3.org/2000/svg"><symbol viewBox="0 0 20 13"preserveAspectRatio="xMinYMin meet"id="close_expanded"><path fill="#9B9B9B"fill-rule="evenodd"d="M17.726 0L10 8.18 2.274 0 0 2.147l10 10.59 10-10.59z"/></symbol><symbol viewBox="0 0 9 14"preserveAspectRatio="xMinYMin meet"id="bug_collapse"><g stroke="#FFF"stroke-width="3"fill="none"fill-rule="evenodd"stroke-linecap="square"><path d="M6.583 11.545L2.417 7M2.417 7l4.166-4.545"/></g></symbol><symbol viewBox="0 0 9 14"preserveAspectRatio="xMinYMin meet"id="bug_open"><g stroke="#FFF"stroke-width="3"fill="none"fill-rule="evenodd"stroke-linecap="square"><path d="M2.417 2.455L6.583 7M6.583 7l-4.166 4.545"/></g></symbol><symbol viewBox="0 0 11 8"preserveAspectRatio="xMinYMin meet"id="small_close"><g stroke="#FFF"stroke-width="3"fill="none"fill-rule="evenodd"stroke-linecap="square"><path d="M8.364 2.278l-3.03 2.778M2.303 2.278l3.03 2.778"/></g></symbol><symbol viewBox="0 0 190 104"preserveAspectRatio="xMinYMin meet"id="lockup_international"><g fill="#333"fill-rule="nonzero"><path d="M121 95.8V93H91.7c.1 1.8-1.7 3.3-3.9 3.3H76.2c-2.2 0-3.9-1.5-3.9-3.3H17V10.3c0-1.8.5-2.3 2.3-2.3h125.4c1.8 0 2.3.5 2.3 2.3V14h3V7.8c0-3.8-3-6.8-6.8-6.8H20.8C17 1 14 4 14 7.8V93H0c-.1 5.5 5.3 10 11.9 10h113.3c-2.5-1.4-4.2-4.1-4.2-7.2z"/><path d="M161 99v-2h-35.1c-2.2 0-2-.8-2-3.1V24.1c0-2.3-.2-3.1 2-3.1h46.2c2.2 0 2 .8 2 3.1V46h1.9V22.2c0-4-3.1-7.2-7-7.2h-40c-3.9 0-7 3.2-7 7.2v73.5c0 4 3.1 7.2 7 7.2h34c-1.2-.8-2-2.3-2-3.9z"/><path d="M177.8 79v-2.9l1.6-1.4-1.6-1.4v-2c1.4-.1 2.4-1.2 2.4-2.5 0-1.7-1.6-2.3-2.5-2.3-.2 0-.4 0-.7.1v.1h.4c.6 0 1.1.3 1.1.9 0 .4-.4.9-1 .9-1.6 0-3.4-1.3-5.5-1.3-1.8 0-3 1.3-3 2.7 0 1.3.8 1.8 1.6 2.1v-.1c-.3-.2-.4-.4-.4-.9 0-.6.6-1.1 1.3-1.1 1.7 0 4.4 1.4 6.2 1.4h.2v2l-1.6 1.4 1.6 1.4V79c-.7.2-1.3.3-2 .3-2.6 0-4.3-1.6-4.3-4.3 0-.6.1-1.3.3-1.9l1.3-.6v5.9l2.7-1.2v-6L172 73c.4-1.2 1.2-2 2.2-2.5v-.1c-2.6.6-5.2 2.6-5.2 5.6 0 3.5 2.9 5.9 6.3 5.9 3.2.1 5.3-2.3 5.2-5.8-.5 1.3-1.4 2.3-2.7 2.9z"/><path d="M184 47h-18c-2.2 0-4 1.8-4 4v48c0 2.2 1.8 4 4 4h18c2.2 0 4-1.8 4-4V51c0-2.2-1.8-4-4-4zm3 48.9c0 1.2.1 2.1-1.1 2.1h-21.8c-1.2 0-1.1-.9-1.1-2.1V54.1c0-1.2-.1-2.1 1.1-2.1h21.8c1.2 0 1.1.9 1.1 2.1v41.8z"/></g></symbol></svg>'
}}}),function(e){"function"==typeof define&&define.amd?define("ecomm/url",["jquery/nyt"],function(t){return e(t)}):"object"==typeof NYTD&&(NYTD.Ecomm=NYTD.Ecomm||{},NYTD.Ecomm.Url=e(NYTD.jQuery||window.jQuery))}(function(e){return{parseUri:function(e){var t=e;"string"==typeof t&&null!==t.match(/http|http/gim)||(t="");for(var n={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[n.strictMode?"strict":"loose"].exec(t),o={},a=14;a--;)o[n.key[a]]=i[a]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,function(e,t,i){t&&(o[n.q.name][t]=i)}),o},parseCurrentUri:function(){return this.parseCurrentUri.result||(this.parseCurrentUri.result=this.parseUri(this.getLocationHref())),this.parseCurrentUri.result},getLocationHref:function(){return location.href},getParameter:function(e){var t=this.parseCurrentUri();return t.queryKey[e]},appendParamsToUrl:function(t,n){if(!t)return null;if(!n||"object"!=typeof n||n instanceof Array)return t;var i=void 0,o=void 0,a={},r=t;return r.indexOf("?")>-1?(i=r.split("?"),o=i[0],a=this.parseUri(r).queryKey):o=r,a=e.extend({},a,n),o+"?"+e.param(a)},getDomain:function(e){var t="string"==typeof e?e:"",n=t.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i);return n?n[1]:void 0},processUrlHref:function(t,n){if(!(t instanceof e)||"object"!=typeof n)return!1;var i=t.attr("href");return!(!i||i.match(/^javascript:/i)||i.match(/^mailto:/i)||i.match(/^tel:/i)||i.match(/#/))&&(i=this.appendParamsToUrl(i,n),void t.attr("href",i))}}}),function(e){"function"==typeof define&&define.amd?define("ecomm/cookies",[],function(){return e()}):"object"==typeof NYTD&&(NYTD.Ecomm=NYTD.Ecomm||{},NYTD.Ecomm.Cookies=e())}(function(){return{getMeterCookieCount:function(){var e=this.get("nyt-m").match(/\bv=i.([0-9]+)/);return!!e&&e[1]},get:function(e){return new RegExp(e+"=([^;]+)","i").test(window.decodeURIComponent(this.getDocumentCookies()))?RegExp.$1:null},set:function(e,t,n){var i=new Date;i.setTime(i.getTime());var o=n;o&&(o=1e3*o*60*60*24);var a=new Date(i.getTime()+o),r=e+"="+t+";path=/"+(o?";expires="+a.toGMTString():"")+";domain=.nytimes.com";this.setDocumentCookies(r)},remove:function(e,t,n,i){var o=e+"=xxx"+(t?";path="+t:";path=/")+(n?";domain="+n:";domain=.nytimes.com")+(i?";secure":"")+"; expires=Thu, 01 Jan 1970 00:00:01 GMT;";this.setDocumentCookies(o)},getDocumentCookies:function(){return document.cookie},setDocumentCookies:function(e){document.cookie=e},getMtrabValues:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new Error("Please specify correct array to process");var t="";return e.filter(function(e){return e&&e.name&&e.variation}).map(function(e,n,i){var o=n===i.length-1;t+=e.name+"="+e.variation,o||(t+="|")}),t},setOrRemoveMtrabCookie:function(e){var t="[object Array]"===Object.prototype.toString.call(e)?e:[e],n=this.getMtrabValues(t);n&&"NaN"!==n?this.set("mtrab",n):this.remove("mtrab")}}}),function(e){"function"==typeof define&&define.amd?define("ecomm/logger",["ecomm/url","ecomm/cookies"],function(t,n){return e(t,n)}):"object"==typeof NYTD&&(NYTD.Ecomm=NYTD.Ecomm||{},NYTD.Ecomm.Logger=e(NYTD.Ecomm.Url,NYTD.Ecomm.Cookies))}(function(e,t){var n=void 0,i=function(){function i(){_classCallCheck(this,i),this.debugQueryString=e.getParameter("debug"),this.debugCookie=t.get("mtr-debug")}return _createClass(i,[{key:"getConsole",value:function(){return window.console}},{key:"isDebugMode",value:function(){return!(!this.debugCookie&&void 0===this.debugQueryString)}},{key:"log",value:function(e){return!("string"!=typeof e||""===e||!this.isDebugMode())&&(this.getConsole().log("[mtr.js] "+e),!0)}}],[{key:"getInstance",value:function(){return void 0===n&&(n=new i,n.constructor=null),n}}]),i}();return i}),function(e){if("function"==typeof define&&define.amd)define("ecomm/utils",["jquery/nyt","ecomm/logger","ecomm/url"],function(t,n,i){var o=n.getInstance();return e(t,"NYT5",o,i)});else if("object"==typeof NYTD){var t=NYTD.Ecomm.Logger.getInstance();NYTD.Ecomm=NYTD.Ecomm||{},NYTD.Ecomm.Utils=e(NYTD.jQuery||window.jQuery,"NYT4",t,NYTD.Ecomm.Url)}}(function(e,t,n,i){var o={getLink:function(e){return e.is("a")?e:e.parents("a").eq(0)},isHrefValid:function(e){var t=this.getLink(e).attr("href"),n=/^javascript:|^#|^mailto:/gim,i=!0;return t&&!t.match(n)||(i=!1),i},runWhenReady:function(e,t,n,i,o){var a=o||5;setTimeout(function r(){e()?t():--a?setTimeout(r,i):n&&n()},i)},getLocation:function(){return window.location},setLocation:function(e){window.location.href=e},isNYT5Env:function(){var e=document.getElementsByName("sourceApp"),t={"nyt-v5":!0,blogs:!0};return"undefined"!=typeof e[0]&&e[0].getAttribute("content")in t},debounce:function(e,t){var n=null;return function(){var i=this,o=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(i,o)},t)}},getNytVersion:function(){return t},isSlideShowApp:function(){return e("html").hasClass("app-slideshow")},checkStringWithRegexp:function(e,t){if(!e||!t)throw new Error("checkStringWithRegexp(): both params should be specified");if("string"!=typeof t||"string"!=typeof e)throw new TypeError("checkStringWithRegexp(): use string as both parameters");var n=new RegExp(e,"i");return n.test(t)},removeGatewayHash:function(){var e=this.getLocation(),t=e.href.replace(/(\?|&)(gwh|gwt)=([^&]+)/gi,"");return e.replace(t),t},addGatewayHash:function(e,t,n){var o="";if(!e)return o;var a=this.getLocation(),r=t?"pay":"regi",s=window.decodeURIComponent(a.href).split("#");s=s.length>1?"#"+s[1]:null;var l=n?"&assetType="+n:"",c="mtrref="+i.getDomain(document.referrer)+"&gwh="+e+"&gwt="+r+l;return o=a.search?a.href+"&"+c:a.href+"?"+c,o=s?o.replace(s,"")+s:o,a.replace(o),o},getGatewayHashFromUri:function(){var e=window.decodeURIComponent(this.getLocation().search);return/gwh=([^&]+)/.test(e)?RegExp.$1:""},cleanUrlFromQueryAndHashes:function(){return this.getLocation().href.replace(/\b(\?|\#).+/g,"")},onEscapeKey:function(e){27===e.keyCode&&e.preventDefault()}};return o}),function(e){if("function"==typeof define&&define.amd)define("ecomm/etTracker",["jquery/nyt","ecomm/utils","ecomm/url","ecomm/cookies","ecomm/logger"],function(t,n,i,o,a){var r=a.getInstance();return e(t,n,i,o,r)});else if("object"==typeof NYTD){var t=NYTD.Ecomm.Logger.getInstance();NYTD.Ecomm=NYTD.Ecomm||{},NYTD.Ecomm.EtTracker=e(NYTD.jQuery||window.jQuery,NYTD.Ecomm.Utils,NYTD.Ecomm.Url,NYTD.Ecomm.Cookies,t)}}(function(e,t,n,i,o){var a=function(){function a(e,t,n){_classCallCheck(this,a),this.config=e,this.$container=e.$container,this.module=e.module,this.region=e.region,this.isDefaultLoaded=n,this.meterCount=e.meterCount||a.getMeterPageCount(),this.contentId=e.campaignName||e.contentId||"",this.skipAnchorTracking=e.skipAnchorTracking||window.NYToptly&&window.NYToptly.skipMtrAnchorTrackingParams||!1,e.isInTest||(this.init(e,t),this.updateAnchorETParamsHandler())}return _createClass(a,[{key:"init",value:function(i,a){o.log("[EtTracker module] init"),this.moduleInteractions=[{selector:".login-modal-trigger",tagxEvent:"login-click",action:"click",etParamKey:"modalLogin"},{selector:".registration-modal-trigger",tagxEvent:"regi-click",action:"click",etParamKey:"modalRegi"}];var r=n.parseUri(document.referrer);if(this.trackingParams={common:{version:"meter at "+this.meterCount,module:this.module,pgtype:t.pageType,region:this.region,contentId:this.contentId,mediaId:this.getMediaId(),referrer:r.host+r.path,priority:!0},load:{action:"Impression",eventName:"Impression"},close:{action:"click",eventName:"Dismiss "+this.module},modalRegi:{module:this.module+"-Regi",action:"click",eventName:"regi-click"},modalLogin:{module:this.module+"-Login",action:"click",eventName:"login-click"},links:{module:this.module+"-Links",source:this.module,action:"click",contentCollection:this.module.toLowerCase()+"-links-click"}},this.trackingParams=e.extend(!0,{},this.trackingParams,i.trackingParams),this.moduleInteractions=this.moduleInteractions.concat(i.moduleInteractions||[]),this.isDefaultLoaded&&this.record(this.module.toLowerCase()+"-load",e.extend({},this.trackingParams.common,this.trackingParams.load),"impression"),this.skipAnchorTracking||this.setAnchorTracking(),a){var s=this.trackingParams,l=this.module;a.setTrackingParams(s,l)}this.setupModuleInteractions()}},{key:"updateAnchorETParamsHandler",value:function(){var t=this;e(document).on(this.module+".updateAnchorETParams",function(){o.log("[EtTracker module] updateAnchorETParamsHandler listener"),t.addAnchorTracking(t.$container,t.trackingParams)})}},{key:"getMediaId",value:function(){var t=e.trim(this.$container.find(".adxInfo, .mktInfo").text()),n="";return t&&/creative:/.test(t)&&(n=t.replace(/.*creative:\s([^,]*).*/,"$1"),n=n.indexOf(" -- ")?e.trim(n.split(" -- ")[0]):n),n}},{key:"setupModuleInteractions",value:function(){for(var e=this,t=this.moduleInteractions||[],n=[],i=0;i<t.length;i++){var o=t[i].action;"click"===o&&(this.moduleInteractions[i].action="mouseup",o="mouseup"),n.indexOf(o)===-1&&n.push(o)}n.forEach(function(t){e.listenTo(t)})}},{key:"listenTo",value:function(e){var t=this;this.$container.on(e,function(e){t.handle(e)})}},{key:"isSelector",value:function(e,t){return e.is(t)||!!e.parents(t).length}},{key:"handle",value:function(t){for(var n=0;n<this.moduleInteractions.length;n++){var i=this.moduleInteractions[n],o=e(t.target);if(this.isSelector(o,i.selector)&&i.action===t.type){var a=3===t.which;a||(this.track(i.tagxEvent,i.etParamKey),i.callback&&"function"==typeof i.callback&&i.callback(t))}}}},{key:"setAnchorTracking",value:function(){var t=this;o.log("[EtTracker module] setAnchorTracking"),this.addAnchorTracking(this.$container,this.trackingParams),e(document).on(this.module+".updateAnchorETParams",function(){o.log("[EtTracker module] setAnchorTracking listener"),t.addAnchorTracking(t.$container,t.trackingParams)})}},{key:"addAnchorTracking",value:function(t,n){var i=this;if(o.log("[EtTracker module] addAnchorTracking"),!(t instanceof e)||"object"!=typeof n)throw new Error("Please specify both params with correct types and values");t.find("a").on("click",function(){i.processLinks(e(this),n)})}},{key:"processLinks",value:function(i,a){if(o.log("[EtTracker module] processLinks -- selector: "+i),!i||!a||"object"!=typeof i||"object"!=typeof a)throw new Error("Please specify both params with correct types and values");var r=e(i),s=a;if(t.isHrefValid(r)){var l=e.extend({},s.common,s.links);o.log("[EtTracker module] processLinks -- tagxArgs: "+JSON.stringify(l)),n.processUrlHref(r,l)}}},{key:"track",value:function(t,n,i){var o=this.trackingParams||{},a=e.extend({},o.common||{},o[n],i||{});this.record(t,a,"interaction")}},{key:"trackMeterUpdate",value:function(e){this.record("nytd:meter:viewedCountUpdated",{v:e})}},{key:"record",value:function(e,n,i){t.runWhenReady(function(){return"TAGX"in window},function(){o.log("[EtTracker module] -- TAGX Tracking Call: "+e+" -- "+(i||"")+" -- "+JSON.stringify(n)),TAGX.EventProxy.trigger(e,n,i)},null,1e3,10)}}],[{key:"getMeterPageCount",value:function(){var e=i.get("nyt-m")||"",t=e.match(/\bv=i\.([0-9]+)/);return t&&t[1]?parseInt(t[1],10):null}}]),a}();return a}),function(e){"function"==typeof define&&define.amd?define("ecomm/overlay",["jquery/nyt","ecomm/utils"],function(t,n){return e(t,n)}):"object"==typeof NYTD&&(NYTD.Ecomm.Overlay=e(NYTD.jQuery||window.jQuery,NYTD.Ecomm.Utils))}(function(e,t){var n=function(){function n(){_classCallCheck(this,n),this.imageHost=window.location.host.indexOf(".stg.")>0?"https://static.stg.nytimes.com":"https://static01.nyt.com"}return _createClass(n,[{key:"add",value:function(e){var t=n.getStyles();n.display(e,t,n.blockContent)}}],[{key:"getStyles",value:function(){var e=void 0,n=t.isSlideShowApp(),i=void 0;return"NYT5"!==t.getNytVersion()||n?("NYT4"===t.getNytVersion()||n)&&(i="background: transparent;\n                    background:-moz-linear-gradient(center bottom , #000, transparent);\n                    background:-ms-linear-gradient(top, transparent, black);\n                    background: -webkit-gradient(linear, left bottom, left top, from(#000), to(transparent));\n                    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000010', endColorstr='#000000')"):i="background: transparent; \n                    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIwLjQiLz4KICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);\n                    background: -moz-linear-gradient(top, rgba(255,255,255,0.4) 0%, rgba(255,255,255,1) 100%);\n                    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0.4)), color-stop(100%,rgba(255,255,255,1)));\n                    background: -webkit-linear-gradient(top, rgba(255,255,255,0.4) 0%,rgba(255,255,255,1) 100%); \n                    background: -o-linear-gradient(top, rgba(255,255,255,0.4) 0%,rgba(255,255,255,1) 100%); \n                    background: -ms-linear-gradient(top, rgba(255,255,255,0.4) 0%,rgba(255,255,255,1) 100%); \n                    background: linear-gradient(to bottom, rgba(255,255,255,0.4) 0%,rgba(255,255,255,1) 100%)",e=i+";",("NYT4"===t.getNytVersion()||document.querySelector("html").classList.contains("page-interactive-blank"))&&(e+=" z-index: 1000000040;"),e}},{key:"display",value:function(t,i,o){return document.body&&document.body.firstChild?(e(t).attr("style",i+"position:fixed;top:0;bottom:0;left:0;right:0;"),void(o&&o())):void n.display(t,i,o)}},{key:"stopScrolling",value:function(){window.scroll(0,0),e("body").css({overflow:"hidden",margin:"0 0 85px 0","padding-right":"15px"}),e("html").css({overflow:"hidden"}),e(document).off("keypress keydown keyup touchmove"),e(document).on("keypress keydown keyup",function(e){if(e.keyCode in{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",36:"HOME",35:"END",33:"PAGEUP",34:"PAGEDOWN"})return e.preventDefault(),!1}),window.Event&&"function"==typeof Event.stopObserving&&(Event.stopObserving(document,"keydown"),Event.stopObserving(document,"keyup"),Event.stopObserving(document,"keypress"),Event.stopObserving(window,"keydown"),Event.stopObserving(window,"keyup"),Event.stopObserving(window,"keypress"))}},{key:"removeNYTClean",value:function(){e("script").each(function(){if(e(this).attr("src")&&e(this).attr("src").toLowerCase().indexOf("euri.ca")>0)return window.location.reload(),!1})}},{key:"blockContent",value:function(){var e=function(){n.stopScrolling(),n.removeNYTClean(),n.scrap()};e(),setInterval(e,1e3)}},{key:"scrap",value:function(){var t=["#article .articleInline","#article #readerscomment","#article .articleFooter","#article .authorIdentification","#article #articleExtras","#article .articleBottomExtra","#article .emailAlertModule","#article #pageLinks","#twitter-widget-0",".videoplayerContainer","iframe",".slideShowModule","#subscribeCallToAction",".comments-panel","#story figure"].join(","),n=["#mtrjsIframe","figure.layout-horizontal-full-bleed",".has-vertical-full-bleed",".layout-vertical-full-bleed",".has-vertical-full-bleed #story figure"].join(",");e(t).not(n).remove(),e(["#article .articleBody p","#content .entry-content p","#content .postContent p","#story .story-body-text"].join(",")).each(function(t,n){var i=1,o=e(n);if(0===t){var a=o.html();a.length&&a.length<400&&(i=2)}if(t===i){var r=e('<p id="subscribeCallToAction" style="text-align: center; margin-top: 28px; font-family: arial,helvetica,sans-serif; font-size: 1.2em; font-weight: bold;"><a  data-content-collection="GWtoDSLP" data-content-placement="1" class="applicationButtonLt" href="https://www.nytimes.com/articlegate" style="width: 250px; padding: 7px 25px !important; font-weight: bold; color: #004276; text-decoration: none"><span>To see the full article, subscribe here.</span></a></p>');r.insertAfter(o)}else t>i&&o.remove()})}}]),n}();return n}),function(e){"function"==typeof define&&define.amd&&define("auth/mtrjsGateway",["jquery/nyt","auth/gateway/creatives","ecomm/utils","ecomm/cookies","ecomm/url","ecomm/overlay","ecomm/etTracker","ecomm/logger"],function(t,n,i,o,a,r,s,l){return e(t,n,i,o,a,r,s,l)})}(function(e,t,n,i,o,a,r,s){var l=s.getInstance(),c=o.getParameter("assetType"),d=function(){function r(){_classCallCheck(this,r)}return _createClass(r,[{key:"showIframeOverlayCreative",value:function(){var e=t.defaultGateways.iframeOverlay;return l.log("[MtrjsGateway module] -- Using iframe Gateway: creatives.defaultGateways.iframeOverlay."),this.displayCreatives(e,"magnoliaGatewayIframe")}},{key:"showRegiWallCreative",value:function(){var e=t.defaultGateways.regiwallCreative;return l.log("[MtrjsGateway module] -- Using regiwallCreative Gateway: creatives.defaultGateways.regiwallCreative."),this.displayCreatives(e,"FREEX_Redbird_Rollout")}},{key:"showStaticCreative",value:function(){var e=t.defaultGateways.backupStatic;return this.displayCreatives(e,"backupStaticGateway")}},{key:"buildCreative",value:function(e){var t=['<div id="gatewayCreative" class="z-index-gateway-overlay">','<div id="gatewayUnit" style="position:fixed;bottom:80px;width:100%;">'].concat(e||"").concat(["</div>","</div>"]).join("");return t}},{key:"addCreative",value:function(e){function t(e,t,n){var i={event:"moduleInteraction",eventData:{pagetype:"article",trigger:"module",type:"click",status:""},module:{name:"Regiwall",context:"",label:"FREEX_Redbird_Rollout",region:o,element:{name:e,label:t,url:n}},eventCallback:m(n)};window.dataLayer.push(i),l.log(" ---------- tracking to dataLayer: "),l.log(i)}var n=this;this.mtrData=e,this.mtrData.threshold=i.get("nyt-m").match(/\bt=i\.([0-9]+)/)[1],this.mtrData.v=i.get("nyt-m").match(/\bv=i\.([0-9]+)/)[1];var o=this.mtrData.v,a=encodeURIComponent("https://www.nytimes.com/subscription/multiproduct/lp8KQUS.html"),r=encodeURIComponent(window.location.href.split("?")[0]),s="https://www.nytimes.com/subscription?campaignId=7Q87L",d="https://myaccount.nytimes.com/auth/register?response_type=cookie&client_id=freex&asset=RegiWall&application=Free_Experience&redirect_uri="+a+"%3FcampaignID%3D7QQFH%26EXIT_URI%3D"+r,p="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=freex&asset=RegiWall&application=Free_Experience&redirect_uri="+a+"%3FcampaignID%3D7QQFH%26EXIT_URI%3D"+r;l.log("assetType = "+c);var m=function(e){document.location=e},g=function(e,n,i,o){e.onclick=function(e){e.stopPropagation(),e.preventDefault(),t(n,i,o)}};if("REGIWALL"===c){n.showRegiWallCreative();var f=document.querySelector(".tracking__continue");g(f,"goto-register","CONTINUE",d);var u=document.querySelector(".tracking__login");g(u,"goto-login","Log in",p);var h=document.querySelector(".tracking__subscription");g(h,"goto-subscribe","See more subscription options",s)}else"PAYWALL"===c&&!function(){n.showIframeOverlayCreative();var e=(new Date).getTime(),t=setInterval(function(){var i=document.getElementById("mtrjsIframe"),o=i.contentDocument.head,a=function(){var t=setInterval(function(){(new Date).getTime()-e>1e4&&(l.log("mtrjs gw gwIframeBodyInterval: 10 seconds reached, timing out"),clearInterval(t)),i.contentDocument.body&&i.contentDocument.body.dataset&&i.contentDocument.body.dataset.pageLoaded&&(l.log("iframe body found, clearing interval!!!"),clearInterval(t),i.contentDocument.body.style.boxSizing="border-box",i.contentDocument.body.style.padding="0 20px",setTimeout(function(){var e=i.contentDocument.body;if(i.src.indexOf("mktgEmbedSrc=gateway")>-1)for(var t=e.getElementsByTagName("a"),n=0;n<t.length;n++)t[n].setAttribute("target","_parent")},500))})},r=function(){var e=document.getElementById("gatewayCreative");e.parentNode.removeChild(e),n.showStaticCreative()};return(new Date).getTime()-e>1e4?(l.log("mtrjs gw: 10 seconds reached, timing out"),clearInterval(t),void r()):void(o&&!o.querySelector("script#mwcm-server-data")?(l.log("mtrjs gw: mwcm-server-data element not found on page, serving backup"),clearInterval(t),r()):(l.log("mtrjs gw: mwcm-server-data element found on page, serving iframe and clearing interval"),clearInterval(t),a()))},500)}()}},{key:"displayCreatives",value:function(e,t){var n=this;if(!e||"string"!=typeof e)throw new Error("please specify correct adCreatives parameter");var i=n.buildCreative(e);r.appendToBody(i,function(){n.showOverlayAndCreative(t)})}},{key:"initializeTagxTracker",value:function(t,i){var o=e.trim(e(e("#gatewayUnit .adxInfo, #gatewayUnit .mktInfo")[0]).text()),a=i,r=this.mtrData;"REGIWALL"===c&&(c="RegiWall"),"PAYWALL"===c&&(c="PayWall"),o&&/campaign:/.test(o)&&(a=o.replace(/.*campaign:\s([^,]*).*/,"$1"));var s={event:"impression",eventData:{},module:{name:c,context:"",label:a,region:r.v}};n.runWhenReady(function(){return window.dataLayer},function(){l.log("push to data layer:"),l.log(s),window.dataLayer.push(s)},function(){},100,10)}},{key:"showOverlayAndCreative",value:function(t){var n=this,i=e("#gatewayCreative");e(".gw-loginlink").each(function(){var t=e(this).attr("href"),n=o.parseCurrentUri();t=o.appendParamsToUrl(t,{URI:n.protocol+"://"+n.host+n.path}),e(this).attr("href",t)}),setTimeout(function(){n.initializeTagxTracker(i,t),e("#overlay").fadeIn(),i.fadeIn()},200)}}],[{key:"appendToBody",value:function(t,n){if(!t||"string"!=typeof t)throw new Error("appendToBody(): Specify correct html content to add");if(document.body){var i=new a;e("html > body").append(t),i.add("#gatewayCreative"),"function"==typeof n&&n()}else setTimeout(function(){r.appendToBody(t,n)},100)}}]),r}();return d}),function(e){"function"==typeof define&&define.amd?define("auth/messages",[],function(){return e()}):"object"==typeof NYTD&&(NYTD.MtrMessages=e())}(function(){return{logout:'<style>.log-in-again{position:fixed;z-index:1000000101;margin:0;padding:10px 0 15px;left:0;bottom:0;width:100%;border-top:1px solid #333;background-color:#fff;display:flex;font-family:nyt-franklin,helvetica,arial,sans-serif;font-weight:500;font-size:14px;line-height:1em;color:#333;flex-flow:row nowrap;justify-content:space-between;align-items:center;max-height:0;overflow-y:hidden;transform:translateY(100%);opacity:0;transition:all 250ms ease-in}.log-in-again-note{flex:1 1 auto;padding:0 15px 7px}.log-in-again-note .accent{font-weight:700}.log-in-again-note a{font:inherit;color:#2C6695;text-decoration:none}@media only screen and (min-width:768px) and (max-width:999999999px){.log-in-again-note{padding:0 0 7px 31px}.log-in-again-note-container{width:705px;margin:0 auto}}.log-in-again-close{flex:0 0 32px}.log-in-again-close button{cursor:pointer;border:none;background-color:transparent;background-image:none;-webkit-box-shadow:none;box-shadow:none;box-sizing:content-box;padding:.25em;margin:0;line-height:1em}.log-in-again-close button *{font-size:24px;font-family:helvetica,sans-serif;font-weight:100;color:#aaa}.open{max-height:100px;transform:translateY(0);opacity:1}</style><div class="log-in-again open"><div class="log-in-again-note"><div class="log-in-again-note-container"><span class="accent">You have been logged out</span> because your session expired. For full access, please <a href="https://myaccount.nytimes.com/auth/login?response_type=cookie&client_id=mtr_js&redirect_uri=https%3A%2F%2Fwww.nytimes.com">log in again</a>.</div></div><div class="log-in-again-close"><button class="log-in-again-close-button"><span>&times;</span></button></div></div>'}}),function(e){if("function"==typeof define&&define.amd)define(["jquery/nyt","auth/mtrjsGateway","ecomm/utils","ecomm/url","ecomm/cookies","ecomm/etTracker","ecomm/logger","auth/messages"],function(t,n,i,o,a,r,s,l){return e(t,n,i,o,a,r,s,l)});else if("object"==typeof NYTD){var t=NYTD;t.Meter=e(t.jQuery||window.jQuery,t.MtrjsGateway,t.Ecomm.Utils,t.Ecomm.Url,t.Ecomm.Cookies,t.Ecomm.EtTracker,t.Ecomm.Logger,t.MtrMessages)}}(function(e,t,n,i,o,a,r,s){var l=[],c=void 0,d=function(){function d(){_classCallCheck(this,d);var t=i.getLocationHref();this.isStg=/stg/.test(t),this.isDebugMode=/debug/.test(t),this.meterSvc=this.isStg?"https://meter-svc.stg.nytimes.com/meter.js?sourceApp=nyt5&callback=?":"https://meter-svc.nytimes.com/meter.js?sourceApp=nyt5&callback=?",this.validateSession=this.isStg?"https://myaccount.stg.nytimes.com/svc/meter/validate-session":"https://myaccount.nytimes.com/svc/meter/validate-session",this.clientId="meter.fe",this.currentCleanUrl=n.cleanUrlFromQueryAndHashes(),this.prevMeterCount=d.getMeterPagesCount(),this.logger=new r,d.meterReady=e.Deferred(),d.trackingParams={}}return _createClass(d,[{key:"init",value:function(){var t=this;if(e(document).on("popstate",function(){t.onUrlChange()}),d.isErrorPage())return e(document).off("keydown",n.onEscapeKey),!1;var i=n.getGatewayHashFromUri(),o=d.getCookieHash();i?i&&!o||i!==o?n.removeGatewayHash():i&&o&&i===o&&(t.loadGateway(),t.updateUserState(),d.meterReady.resolve()):t.checkMeter()}},{key:"onUrlChange",value:function(){var e=n.cleanUrlFromQueryAndHashes();this.currentCleanUrl!==e&&(this.checkMeter({url:n.getLocation().href,referrer:this.currentCleanUrl}),this.currentCleanUrl=e)}},{key:"updateUserState",value:function(){return!n.isNYT5Env()&&void e.ajax({dataType:"jsonp",url:this.meterSvc,data:{url:n.getLocation().href},success:function(t){t.loggedIn&&e("html").addClass("user-logged-in")}})}},{key:"loadGateway",value:function(){var n=void 0;return d["final"]=!0,e(document).trigger("NYTD:MeterFinal",d),n=new t,n&&n.addCreative(d),n}},{key:"checkMeter",value:function(t){var i=t||{url:n.getLocation().href,referrer:document.referrer};e(document).on("keydown",n.onEscapeKey),d.loaded=!1,this.get(i||{})}},{key:"dedupeQueryString",value:function(e){var t=e.split("&"),n={};return t.forEach(function(e){n[e]=0}),Object.keys(n).join("&")}},{key:"getAbtestCookie",value:function(){var e=o.get("mtrab");return e&&(e=e.replace(/\|/g,"$"),e=encodeURIComponent(e),e=e.replace(/%3D/g,"=")),e}},{key:"getQaMeterFlagsCookie",value:function(){var e=o.get("qa_meter_flags");return e&&(e=encodeURIComponent(e),e=e.replace(/%3D/g,"="),e=e.replace(/%26/g,"&")),e}},{key:"getAbraMeterConfig",value:function(){var e={};return e.customDefaults=window.NYTD&&window.NYTD.Abra&&window.NYTD.Abra("MKT_customDefaults"),e}},{key:"get",value:function(t){var i=this,o=t&&t.url?t.url:n.getLocation().href,a=t&&null!==t.referrer&&void 0!==t.referrer?t.referrer:n.getLocation().href;t&&t.callback&&l.push(t.callback);var r=e("meta").filter('[name="channels"]').attr("content"),s="",c=void 0;"undefined"!=typeof r&&(s="&channels="+encodeURIComponent(r));var p=this.getQaMeterFlagsCookie();p&&(s+="&"+p);var m=this.getAbraMeterConfig(),g=m&&m.meterTestQueryParams;g&&(s+="&"+g);var f=this.getAbtestCookie();f&&(s+="&"+f,s=this.dedupeQueryString(s)),c=this.meterSvc+s,e.ajax({dataType:"jsonp",url:c,data:{url:o,referer:a},success:function(e){i.onMeterLoaded(e,t,o,m)},error:function(e,t,n){i.logger.log(n),d.meterReady.reject()}})}},{key:"onMeterLoaded",value:function(t,i,r,l){var c=void 0,p=this.validateSession,m=this.clientId;return this.etTracker=new a({$container:e("body"),module:"meter",skipAnchorTracking:!0},d,(!0)),t.v&&t.v!==this.prevMeterCount&&(this.etTracker.meterCount=t.v,this.etTracker.trackMeterUpdate(t.v)),t.assetType&&(c=t.assetType),e("head").append('<meta name="WT.z_cad" content="'+(t.counted?"1":"0")+'" /> '),parseInt(t.v,10)>=parseInt(t.t,10)&&o.setOrRemoveMtrabCookie(t.ab),t.hitPaywall||t.hitRegiwall?void n.addGatewayHash(t.hash,t.hitPaywall,t.gatewayType):(t.nytsNeedsRefresh&&e.ajax({url:p,headers:{client_id:m},type:"POST",dataType:"json",success:function(t){"Y"===t.data.need_relogin&&!function(){var t=e("<div class='mtr-message-container'></div>");t.append(s.logout),e("body").append(t);new a({$container:e(".mtr-message-container"),module:"session-refresh",skipAnchorTracking:!0,contentId:"Re-login session refresh",moduleInteractions:[{selector:".log-in-again-close-button",action:"click",tagxEvent:"session-refresh-close",etParamKey:"close",callback:function(){t.on("click",".log-in-again-close-button",function(t){t.preventDefault(),e(".log-in-again").removeClass("open")})}}]},d,(!0))}()},xhrFields:{withCredentials:!0}}),this.completeInitialization(t,l,r,c),void d.meterReady.resolve())}},{key:"fillResponseObject",value:function(e,t,n,i,o){if(!e||!n)throw new Error("Please specify all required params.");var a=d.getMeterPagesCount(),r=o||d;return r.ab=e.ab,r.customDefaults=t.customDefaults,r.loaded=!0,r["final"]=!0,r.meterOn=e.meter,r.gatewayOn=e.gateway,r.hitPaywall=e.hitPaywall,r.hitRegiwall=e.hitRegiwall,r.gatewayType=e.gatewayType,r.cookieValid=e.isCookieValid,r.isLoggedIn=e.loggedIn,r.gatewayExempt=e.gatewayExempt,r.pageCount=a,r.url=n,r.assetType=i,r.counted=e.counted,r.threshold=e.t,r}},{key:"setUserLoggedInFlag",value:function(t){t.loggedIn&&e("html").addClass("user-logged-in")}},{key:"executeCallbacks",value:function(){e.each(l,function(e,t){t(d)}),l=[]}},{key:"triggerMeterHasBeenLoadedEvents",value:function(){e(document).trigger("NYTD:MeterLoaded",d),e(document).trigger("NYTD:MeterFinal",d)}},{key:"stopBlockingEscapeKey",value:function(){e(document).off("keydown",n.onEscapeKey)}},{key:"completeInitialization",value:function(e,t,n,i){this.fillResponseObject(e,t,n,i),this.setUserLoggedInFlag(e),this.executeCallbacks(),this.triggerMeterHasBeenLoadedEvents(),this.stopBlockingEscapeKey()}}],[{key:"setTrackingParams",value:function(e,t){d.trackingParams[t]=e}},{key:"getInstance",value:function(){return void 0===c&&(c=new d,c.constructor=null),c}},{key:"isErrorPage",value:function(){var e=document.getElementsByName("PST")[0],t=document.getElementsByTagName("title")[0],n=!1;return t&&t.innerHTML&&(n=/Page Not Found|Page unavailable/i.test(t.innerHTML)),!!(e&&e.content&&e.content.match(/error/i))||n}},{key:"getMeterPagesCount",value:function(){var e=d.processMeterCookie().match(/\bv=i\.([0-9]+)/);return e&&e[1]?parseInt(e[1],10):null}},{key:"processMeterCookie",value:function(){var e=o.get("nyt-m")||"";return e}},{key:"getCookieHash",value:function(){var e=32;return d.processMeterCookie().substr(0,e)}}]),d}();return c=d.getInstance(),c.init(),d.check=c.checkMeter,d});